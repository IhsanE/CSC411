P(y=k|x\quad ;\quad \mu ,\sigma )\quad =\quad \frac { P(x|y=k\quad ;\quad \mu ,\sigma )\quad \cdot \quad P(y=k\quad |\quad \mu ,\sigma ) }{ P(x\quad |\quad \mu ,\sigma ) } \\ \quad \quad \quad \quad \quad \quad \quad \quad \quad \quad \quad \quad \quad =\quad \frac { P(x|y=k\quad ;\quad \mu ,\sigma )\quad \cdot \quad P(y=k\quad |\quad \mu ,\sigma ) }{ \sum _{ y=1 }^{ k }{ (P(x|y\quad ;\quad \mu ,\sigma )\quad \cdot \quad  } P(y\quad |\quad \mu ,\sigma )) } \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \ell (\theta ;D)\quad =\quad -log(P({ y }^{ (1) },{ x }^{ (1) },{ y }^{ (2) },{ x }^{ (2) },...,{ y }^{ (N) },{ x }^{ (N) }|\theta ))\\ \qquad \qquad =\quad -log(P({ x }^{ (1) },{ y }^{ (1) },{ x }^{ (2) },{ y }^{ (2) }...,{ x }^{ (N) },{ y }^{ (N) }|\theta ))\\ \qquad \qquad =\quad -log(P({ x }^{ (1) },{ y }^{ (1) }|\theta )\quad \cdot \quad P({ x }^{ (2) },{ y }^{ (2) }|\theta )\quad \cdot \quad ...\quad \cdot \quad P({ x }^{ (N) },{ y }^{ (N) }|\theta ))\\ \qquad \qquad =\quad -\sum _{ i=1 }^{ N }{ log(P({ x }^{ (i) },{ y }^{ (i) }|\theta )) } \\ \qquad \qquad =\quad -\sum _{ i=1 }^{ N }{ log(P(x^{ (i) }|{ y }^{ (i) }\quad ;\quad \theta )\quad \cdot \quad P({ y }^{ (i) }\quad |\quad \theta )) } \\ \qquad \qquad =\quad -\sum _{ i=1 }^{ N }{ log(P(x^{ (i) }|{ y }^{ (i) }\quad ;\quad \theta ))\quad +\quad log(P({ y }^{ (i) }\quad |\quad \theta )) } \\ \qquad \qquad =\quad -\sum _{ i=1 }^{ N }{ log(P(x^{ (i) }|{ y }^{ (i) }\quad ;\quad \theta ))\quad -\sum _{ i=1 }^{ N }{ log({ \alpha  }_{ { y }^{ (i) } }) }  } \\ \qquad \qquad =\quad -\sum _{ i=1 }^{ N }{ [log{ (\prod _{ j=1 }^{ D }{ 2\pi { \sigma  }_{ j }^{ 2 } } ) }^{ -1/2 }\quad +\quad log(exp\left\{ -\sum _{ j=1 }^{ D }{ \frac { { ({ x }_{ j }^{ (i) }-{ \mu  }_{ { y }^{ (i) }j }) }^{ 2 } }{ 2{ \sigma  }_{ j }^{ 2 } }  }  \right\} )]\quad -\sum _{ i=1 }^{ N }{ log({ \alpha  }_{ { y }^{ (i) } }) }  } \\ \qquad \qquad =\quad -\sum _{ i=1 }^{ N }{ [-\frac { 1 }{ 2 } log{ (\prod _{ j=1 }^{ D }{ 2\pi { \sigma  }_{ j }^{ 2 } } ) }\quad +\quad \left\{ -\sum _{ j=1 }^{ D }{ \frac { { ({ x }_{ j }^{ (i) }-{ \mu  }_{ { y }^{ (i) }j }) }^{ 2 } }{ 2{ \sigma  }_{ j }^{ 2 } }  }  \right\} ]\quad -\sum _{ i=1 }^{ N }{ log({ \alpha  }_{ { y }^{ (i) } }) }  } \\ \qquad \qquad =\quad -\sum _{ i=1 }^{ N }{ [-\frac { 1 }{ 2 } log{ (\prod _{ j=1 }^{ D }{ 2\pi { \sigma  }_{ j }^{ 2 } } ) }\quad -\sum _{ j=1 }^{ D }{ \frac { { ({ x }_{ j }^{ (i) }-{ \mu  }_{ { y }^{ (i) }j }) }^{ 2 } }{ 2{ \sigma  }_{ j }^{ 2 } }  } ]\quad -\sum _{ i=1 }^{ N }{ log({ \alpha  }_{ { y }^{ (i) } }) }  } \\ \qquad \qquad =\quad \sum _{ i=1 }^{ N }{ [\frac { 1 }{ 2 } \sum _{ j=1 }^{ D }{ log(2\pi { \sigma  }_{ j }^{ 2 }) } \quad +\sum _{ j=1 }^{ D }{ \frac { { ({ x }_{ j }^{ (i) }-{ \mu  }_{ { y }^{ (i) }j }) }^{ 2 } }{ 2{ \sigma  }_{ j }^{ 2 } }  } ]\quad -\sum _{ i=1 }^{ N }{ log({ \alpha  }_{ { y }^{ (i) } }) }  } \\ \qquad \qquad =\quad \sum _{ i=1 }^{ N }{ [\frac { 1 }{ 2 } \sum _{ j=1 }^{ D }{ log(2\pi { \sigma  }_{ j }^{ 2 }) } \quad +\sum _{ j=1 }^{ D }{ \frac { { ({ x }_{ j }^{ (i) }-{ \mu  }_{ { y }^{ (i) }j }) }^{ 2 } }{ 2{ \sigma  }_{ j }^{ 2 } }  } ]\quad -\sum _{ i=1 }^{ N }{ log({ \alpha  }_{ { y }^{ (i) } }) }  } \\ 